function userAction(t){let s=new Object;s.token2=token2,$.each($("#form").serializeArray(),function(t,e){s[e.name]=e.value}),$("input:checkbox:checked").each(function(){s[$(this).attr("name")]=1});let e=$(".btn__"+t);e.prop("disabled",!0),loader(),$.ajax({type:"POST",url:"/"+t,data:s}).done(function(s){let o=JSON.parse(s);if($(".is-invalid").removeClass("is-invalid"),"ok"==o)"signup"==t?(toastMsg="Вы успешно зарегистрированы",locationHref="/cabinet"):"settings"==t?(toastMsg="Настройки сохранены",locationHref="/cabinet"):"login"==t?(toastMsg="Вы успешно авторизованы",locationHref="/login"):"recovery"==t&&(toastMsg="Новый пароль отправлен на вашу электронную почту",locationHref="/login"),"/order"==getCookie("referrer")&&(deleteCookie("referrer"),locationHref="/order"),$(".toast").removeClass("text-bg-danger"),$(".toast").addClass("text-bg-success"),$(".toast-body").html('<i class="fa-solid fa-check"></i>&nbsp;&nbsp;'+toastMsg),toast.show(),setTimeout(function(){location.href=locationHref},toastTimeout);else{if(o.length>0){if("auth"==o)toastMsg="Электронная почта или пароль введены неправильно",$(".form-control").addClass("is-invalid");else if("non-unique"==o||"non-exist"==o)toastMsg="Введите другую электронную почту",$("#email").addClass("is-invalid");else if("password"==o)toastMsg="Неправильно введен старый пароль",$("#password").addClass("is-invalid");else{let t="";for(let s in o)t+="<br>&mdash;&nbsp;&nbsp;"+$("#"+o[s]+"~ .feedback-short").html(),$("#"+o[s]).addClass("is-invalid");toastMsg='<strong><i class="fa-solid fa-triangle-exclamation"></i>&nbsp;&nbsp;Необходимо ввести:</strong>'+t}$(".toast").addClass("text-bg-danger"),$(".toast-body").html(toastMsg),toast.show()}e.prop("disabled",!1),loader(0)}})}$(function(){$(".btn__signup").click(function(){userAction("signup")}),$(".btn__login").click(function(){userAction("login")}),$(".btn__settings").click(function(){userAction("settings")}),$(".btn__recovery").click(function(){userAction("recovery")})});